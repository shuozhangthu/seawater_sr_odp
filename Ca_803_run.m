% simulate the calcium in the pore water
close all;
clear all;

Ca_803_main;

t_step = 0.059830436216530;

z = [0;1;2;3;4;5;6;7;8;9;10;10.9900000000000;11.9800000000000;12.9700000000000;13.9600000000000;14.9500000000000;15.9400000000000;16.9300000000000;17.9200000000000;18.9100000000000;19.9000000000000;20.8800000000000;21.8600000000000;22.8400000000000;23.8200000000000;24.8000000000000;25.7800000000000;26.7600000000000;27.7400000000000;28.7200000000000;29.7000000000000;30.6700000000000;31.6400000000000;32.6100000000000;33.5800000000000;34.5500000000000;35.5200000000000;36.4900000000000;37.4600000000000;38.4300000000000;39.4000000000000;40.3700000000000;41.3300000000000;42.2900000000000;43.2500000000000;44.2100000000000;45.1700000000000;46.1300000000000;47.0900000000000;48.0500000000000;49.0100000000000;49.9700000000000;50.9300000000000;51.8900000000000;52.8400000000000;53.7900000000000;54.7400000000000;55.6900000000000;56.6400000000000;57.5900000000000;58.5400000000000;59.4900000000000;60.4400000000000;61.3900000000000;62.3400000000000;63.2900000000000;64.2300000000000;65.1700000000000;66.1100000000000;67.0500000000000;67.9900000000000;68.9300000000000;69.8700000000000;70.8100000000000;71.7500000000000;72.6900000000000;73.6300000000000;74.5700000000000;75.5100000000000;76.4400000000000;77.3700000000000;78.3000000000000;79.2300000000000;80.1600000000000;81.0900000000001;82.0200000000001;82.9500000000001;83.8800000000001;84.8100000000001;85.7400000000001;86.6700000000001;87.6000000000001;88.5300000000001;89.4500000000001;90.3700000000001;91.2900000000001;92.2100000000001;93.1300000000001;94.0500000000001;94.9700000000001;95.8900000000001;96.8100000000001;97.7300000000001;98.6500000000001;99.5700000000001;100.490000000000;101.410000000000;102.320000000000;103.230000000000;104.140000000000;105.050000000000;105.960000000000;106.870000000000;107.780000000000;108.690000000000;109.600000000000;110.510000000000;111.420000000000;112.330000000000;113.240000000000;114.150000000000;115.060000000000;115.960000000000;116.860000000000;117.760000000000;118.660000000000;119.560000000000;120.460000000000;121.360000000000;122.260000000000;123.160000000000;124.060000000000;124.960000000000;125.860000000000;126.760000000000;127.660000000000;128.560000000000;129.460000000000;130.360000000000;131.250000000000;132.140000000000;133.030000000000;133.920000000000;134.810000000000;135.700000000000;136.590000000000;137.480000000000;138.370000000000;139.260000000000;140.150000000000;141.040000000000;141.930000000000;142.820000000000;143.710000000000;144.600000000000;145.500000000000;146.380000000000;147.260000000000;148.150000000000;149.030000000000;149.910000000000;150.790000000000;151.670000000000;152.550000000000;153.430000000000;154.310000000000;155.190000000000;156.070000000000;156.950000000000;157.830000000000;158.710000000000;159.590000000000;160.470000000000;161.350000000000;162.220000000000;163.090000000000;163.960000000000;164.830000000000;165.700000000000;166.570000000000;167.440000000000;168.310000000000;169.180000000000;170.050000000000;170.920000000000;171.790000000000;172.660000000000;173.530000000000;174.400000000000;175.260000000000;176.130000000000;177.000000000000;177.870000000000;178.730000000000;179.590000000000;180.450000000000;181.310000000000;182.170000000000;183.030000000000;183.890000000000;184.750000000000;185.610000000000;186.470000000000;187.330000000000;188.190000000000;189.050000000000;189.910000000000;190.770000000000;191.630000000000;192.490000000000;193.350000000000;194.210000000000;195.070000000000;195.930000000000;196.780000000000;197.630000000000;198.480000000000;199.330000000000;200.180000000000;201.030000000000;201.880000000000;202.730000000000;203.580000000000;204.430000000000;205.280000000000;206.130000000000;206.980000000000;207.830000000000;208.680000000000;209.530000000000;210.380000000000;211.230000000000;212.080000000000;212.930000000000;213.780000000000;214.630000000000;215.470000000000;216.310000000000;217.150000000000;217.990000000000;218.830000000000;219.670000000000;220.510000000000;221.350000000000;222.190000000000;223.030000000000;223.870000000000;224.710000000000;225.550000000000;226.390000000000;227.230000000000;228.070000000000;228.910000000000;229.750000000000;230.590000000000;231.430000000000;232.270000000000;233.110000000000;233.950000000000;234.790000000000;235.620000000000;236.450000000000;237.280000000000;238.110000000000;238.940000000000;239.770000000000;240.600000000000;241.430000000000;242.260000000000;243.090000000000;243.920000000000;244.750000000000;245.580000000000;246.410000000000;247.240000000000;248.070000000000;248.900000000000;249.730000000000;250.560000000000;251.390000000000;252.220000000000;253.050000000000;253.880000000000;254.710000000001;255.540000000001;256.360000000001;257.180000000001;258.000000000001;258.820000000001;259.640000000001;260.460000000001;261.280000000001;262.100000000001;262.920000000000;263.740000000000;264.560000000000;265.380000000000;266.200000000000;267.020000000000;267.840000000000;268.660000000000;269.480000000000;270.300000000000;271.120000000000;271.940000000000;272.760000000000;273.580000000000;274.400000000000;275.220000000000;276.040000000000;276.860000000000;277.680000000000;278.490000000000;279.300000000000;280.110000000000;280.920000000000;281.730000000000;282.540000000000;283.350000000000;284.160000000000;284.970000000000;285.780000000000;286.590000000000;287.400000000000;288.210000000000;289.020000000000;289.830000000000;290.640000000000;291.450000000000;292.260000000000;293.070000000000;293.880000000000;294.690000000000;295.500000000000;296.310000000000;297.120000000000;297.930000000000;298.740000000000;299.550000000000;300.360000000000;301.170000000000;301.980000000000;302.780000000000;303.580000000000;304.380000000000;305.180000000000;305.980000000001;306.780000000001;307.580000000001;308.380000000001;309.180000000001;309.980000000001;310.780000000001;311.580000000001;312.380000000001;313.180000000001;313.980000000001;314.780000000001;315.580000000001;316.380000000001;317.180000000001;317.980000000001;318.780000000001;319.580000000001;320.380000000001;321.180000000001;321.980000000001;322.780000000001;323.580000000001;324.380000000001;325.180000000001;325.980000000001;326.780000000001;327.570000000001;328.360000000001;329.150000000001;329.940000000001;330.730000000001;331.520000000001;332.310000000001;333.100000000001;333.890000000001;334.680000000001;335.470000000001;336.260000000001;337.050000000001;337.840000000001;338.630000000001;339.420000000001;340.210000000001;341.000000000001;341.790000000001;342.580000000001;343.370000000001;344.160000000001;344.950000000001;345.740000000001;346.530000000001;347.320000000001;348.110000000001;348.900000000001;349.690000000001;350.480000000001;351.270000000001;352.060000000001;352.850000000001;353.640000000001;354.420000000001;355.200000000001;355.980000000001;356.760000000001;357.540000000001;358.320000000001;359.100000000001;359.880000000001;360.660000000001;361.440000000001;362.220000000001;363.000000000001;363.780000000001;364.560000000001;365.340000000001;366.120000000001;366.900000000001;367.680000000001;368.460000000001;369.240000000001;370.020000000001;370.800000000001;371.580000000001;372.360000000001;373.140000000001;373.920000000001;374.700000000001;375.480000000001;376.260000000001;377.040000000001;377.820000000001;378.600000000001;379.380000000001;380.160000000001;380.940000000001;381.720000000001;382.500000000000;383.270000000000;384.040000000000;384.810000000000;385.580000000000;386.350000000000;387.120000000000;387.890000000000;388.660000000000;389.430000000000;390.200000000000;390.970000000000;391.740000000000;392.510000000000;393.280000000000;394.050000000000;394.820000000000;395.590000000000;396.360000000000;397.130000000000;397.900000000000;398.670000000000;399.440000000000;400.210000000000;400.980000000000;401.750000000000;402.520000000000;403.290000000000;404.060000000000;404.830000000000;405.600000000000;406.370000000000;407.140000000000;407.910000000000;408.680000000000;409.450000000000;410.230000000000;411.000000000000;411.770000000000;412.540000000000;413.310000000000;414.070000000000;414.830000000000;415.590000000000;416.350000000000;417.110000000000;417.870000000000;418.630000000000;419.390000000000;420.150000000000;420.910000000000;421.670000000000;422.430000000000;423.190000000000;423.950000000000;424.710000000000;425.470000000000;426.230000000000;426.990000000000;427.750000000000;428.510000000000;429.270000000000;430.030000000000;430.790000000000;431.550000000000;432.310000000000;433.070000000000;433.830000000000;434.589999999999;435.349999999999;436.109999999999;436.869999999999;437.629999999999;438.389999999999;439.149999999999;439.909999999999;440.669999999999;441.429999999999;442.189999999999;442.949999999999;443.709999999999;444.469999999999;445.229999999999;445.989999999999;446.749999999999;447.499999999999;448.249999999999;448.999999999999;449.749999999999;450.499999999999;451.249999999999;451.999999999999;452.749999999999;453.499999999999;454.249999999999;454.999999999999;455.749999999999;456.499999999999;457.249999999999;457.999999999999;458.749999999999;459.499999999999;460.249999999999;460.999999999999;461.749999999999;462.499999999999;463.249999999999;463.999999999999;464.749999999999;465.499999999999;466.249999999999;466.999999999999;467.749999999999;468.499999999999;469.249999999999;469.999999999999;470.749999999999;471.499999999999;472.249999999999;472.999999999999;473.749999999999;474.499999999999;475.249999999999;475.999999999999;476.749999999999;477.499999999999;478.249999999999;478.999999999999;479.749999999999;480.499999999999;481.249999999999;481.999999999999;482.749999999999;483.489999999999;484.229999999999;484.969999999999;485.709999999999;486.449999999999;487.189999999999;487.929999999999;488.669999999999;489.409999999999;490.149999999999;490.889999999999;491.629999999999;492.369999999999;493.109999999999;493.849999999999;494.589999999999;495.330000000000;496.070000000000;496.810000000000;497.550000000000;498.290000000000;499.030000000000;499.770000000000;500.510000000000;501.250000000000;501.990000000000;502.730000000000;503.470000000000;504.210000000000;504.950000000000;505.690000000000;506.430000000000;507.170000000000;507.910000000000;508.650000000000;509.390000000000;510.130000000000;510.870000000000;511.610000000000;512.350000000000;513.090000000000;513.830000000000;514.570000000000;515.300000000000;516.040000000000;516.780000000000;517.520000000000;518.260000000000;519.000000000000;519.740000000000;520.480000000000;521.220000000000;521.950000000000;522.680000000000;523.410000000000;524.140000000000;524.870000000000;525.600000000000;526.330000000000;527.060000000000;527.790000000000;528.520000000000;529.250000000000;529.980000000000;530.710000000000;531.440000000000;532.170000000000;532.900000000000;533.630000000000;534.360000000000;535.090000000000;535.820000000000;536.550000000000;537.280000000000;538.010000000000;538.740000000000;539.470000000000;540.200000000000;540.930000000000;541.660000000000;542.390000000000;543.120000000000;543.850000000000;544.580000000000;545.310000000000;546.040000000000;546.770000000000;547.500000000001;548.230000000001;548.960000000001];
z_step = [0;1;1;1;1;1;1;1;1;1;1;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.900000000000000;0.880000000000000;0.880000000000000;0.890000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.860000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.780000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.730000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000];

alpha=y(1);
beta=y(2);
gamma=y(3);
R_net = alpha+beta*exp(-z/gamma) ;

v=y(4);
gra_ca = y(5);

%------- initialize parameters------
J = length(z);
N = J;

t = zeros(N,1); 
for i = 2:N
    t(i) = t(i-1) + t_step;
end

fc=1.0;

rho_s = 2.7;    % g/cm^3 ->g/m^3
rho_f = 1;      % g/cm^3 ->g/m^3

temp_T = 0.007926*z+275.1;

f_a = 0;
f_b = 68.6/100;
f_c = 1/0.00075;
phi_z = f_a + f_b*exp(-z/f_c);  % porosity over depth

D0 = zeros(length(z),1);
D_ca = zeros(length(z),1);

for i = 1:length(z)
    D0(i) = (3.69+ 0.169 * (temp_T(i)-273.15)) * 3.65 * 24 * 36;
    D_ca(i) = D0(i) / (1-log(phi_z(i)^2));
end


J = length(z);
N = length(t);
Ca_pore = zeros(N,J);
K_aq = 0;   % adsoprtion coefficient 


for n =1:N
    Ca_pore(n,n:n+1) = 10.62 + 0.161*t(N-n+1);    
end

Ca_pore(2,1) = Ca_pore(2,2)+ z_step(2)* gra_ca;


%-----calculation
for n = 2: N-1
    
    a10 = 2*D_ca(n-2+1)*t_step/z_step(n-2+2)^2;
    b10 = t_step*v/z_step(n-2+2);

    Ca_pore(n+1,2) = ((a10-b10)*Ca_pore(n,2+1) + (a10+b10)*(Ca_pore(n, 3) + 2 * z_step(n)* gra_ca) + (1-a10)*Ca_pore(n-1,2) + 2*10*1000 * t_step * R_net(n-2+1) *fc* rho_s / rho_f * (1-phi_z(n-2+2)) / phi_z(n-2+2)) / (1+a10);
      
    for j = 3:n
        
        a1 = 2*D_ca(n-j+1)*t_step/z_step(n-j+2)^2;
        b1 = t_step*v/z_step(n-j+2);
        
        Ca_pore(n+1,j) = ((a1-b1)*Ca_pore(n,j+1) + (a1+b1)*Ca_pore(n,j-1) + (1-a1)*Ca_pore(n-1,j) + 2*10*1000 * t_step * R_net(n-j+1) *fc* rho_s / rho_f * (1-phi_z(n-j+2)) / phi_z(n-j+2)) / (1+a1);
        
    end
    
    
end

Ca_pore(:,1)=Ca_pore(:,2);


t_total = t(end);

t1 = round((t_total - 35)/t_step);
t2 = round((t_total - 30)/t_step);
t3 = round((t_total - 25)/t_step);

figure
plot(fliplr(Ca_pore(N,1:J)),z,'linewidth',2)
hold on
plot(fliplr(Ca_pore(N-t1,1:J-t1)),z(1+t1:end),'--','linewidth',2)
plot(fliplr(Ca_pore(N-t2,1:J-t2)),z(1+t2:end),':','linewidth',2)
plot(fliplr(Ca_pore(N-t3,1:J-t3)),z(1+t3:end),'-.','linewidth',2)


set(gca,'Ydir','reverse')
title("Site 803");
xlabel('Calcium (mM) in pore water');
ylabel('Present-day depth (m)')
set(gca,'FontSize',12)

[Leg1,Site1,Topcm1,Botcm,Depthmbsf1,CalciumCamM,ChlorinityClmM,MagnesiumMgmM,pHpHna,SodiumNamM,StrontiumSruM,SulfateSO4mM,SilicaH4SiO4uM,AlkalinityALKmM,SalinitySALna] = importfile_water('water.xlsx');

index=(Site1==site_Number);
depth2=Depthmbsf1(index);
Ca2_data=CalciumCamM(index);

scatter (Ca2_data,depth2);

legend('t=39.8 m.y., present day','t=35 m.y.','t=30 m.y.','t=25 m.y.','Calcium Data')

% print('calcium803.jpg','-djpeg','-r600');
% print('calcium803.pdf','-dpdf');
savefig('calcium803.fig');

