% simulate the calcium in the pore water
close all;
clear all;

Ca_805_main;

t_step = 0.038509887841343;

z = [0;1;2;3;4;5;6;7;8;9;9.99000000000000;10.9800000000000;11.9700000000000;12.9600000000000;13.9500000000000;14.9400000000000;15.9300000000000;16.9200000000000;17.9100000000000;18.8900000000000;19.8700000000000;20.8500000000000;21.8300000000000;22.8100000000000;23.7900000000000;24.7700000000000;25.7500000000000;26.7300000000000;27.7000000000000;28.6700000000000;29.6400000000000;30.6100000000000;31.5800000000000;32.5500000000000;33.5200000000000;34.4900000000000;35.4600000000000;36.4300000000000;37.3900000000000;38.3500000000000;39.3100000000000;40.2700000000000;41.2300000000000;42.1900000000000;43.1500000000000;44.1100000000000;45.0700000000000;46.0300000000000;46.9800000000000;47.9300000000000;48.8800000000000;49.8300000000000;50.7800000000000;51.7300000000000;52.6800000000000;53.6300000000000;54.5800000000000;55.5300000000000;56.4800000000000;57.4200000000000;58.3600000000000;59.3000000000000;60.2400000000000;61.1800000000000;62.1200000000000;63.0600000000000;64.0000000000000;64.9400000000000;65.8800000000000;66.8200000000000;67.7600000000000;68.6900000000000;69.6200000000000;70.5500000000000;71.4800000000000;72.4100000000000;73.3400000000001;74.2700000000001;75.2000000000001;76.1300000000001;77.0600000000001;77.9900000000001;78.9200000000001;79.8400000000001;80.7600000000001;81.6800000000001;82.6000000000001;83.5200000000001;84.4400000000001;85.3600000000001;86.2800000000001;87.2000000000001;88.1200000000001;89.0400000000001;89.9600000000001;90.8800000000001;91.7900000000001;92.7000000000001;93.6100000000001;94.5200000000001;95.4300000000001;96.3400000000001;97.2500000000001;98.1600000000001;99.0700000000001;99.9800000000001;100.890000000000;101.800000000000;102.710000000000;103.610000000000;104.510000000000;105.410000000000;106.310000000000;107.210000000000;108.110000000000;109.010000000000;109.910000000000;110.810000000000;111.710000000000;112.610000000000;113.510000000000;114.410000000000;115.310000000000;116.210000000000;117.100000000000;117.990000000000;118.880000000000;119.770000000000;120.660000000000;121.550000000000;122.440000000000;123.330000000000;124.220000000000;125.110000000000;126.000000000000;126.890000000000;127.780000000000;128.670000000000;129.560000000000;130.440000000000;131.320000000000;132.200000000000;133.080000000000;133.960000000000;134.840000000000;135.720000000000;136.600000000000;137.480000000000;138.360000000000;139.240000000000;140.120000000000;141.000000000000;141.880000000000;142.760000000000;143.640000000000;144.510000000000;145.380000000000;146.250000000000;147.120000000000;147.990000000000;148.860000000000;149.730000000000;150.600000000000;151.470000000000;152.340000000000;153.210000000000;154.080000000000;154.950000000000;155.820000000000;156.690000000000;157.560000000000;158.430000000000;159.290000000000;160.150000000000;161.010000000000;161.870000000000;162.730000000000;163.590000000000;164.450000000000;165.310000000000;166.170000000000;167.030000000000;167.890000000000;168.750000000000;169.610000000000;170.470000000000;171.330000000000;172.190000000000;173.050000000000;173.910000000000;174.760000000000;175.610000000000;176.460000000000;177.310000000000;178.160000000000;179.010000000000;179.860000000000;180.710000000000;181.560000000000;182.410000000000;183.260000000000;184.110000000000;184.960000000000;185.810000000000;186.660000000000;187.510000000000;188.360000000000;189.210000000000;190.060000000000;190.910000000000;191.750000000000;192.590000000000;193.430000000000;194.270000000000;195.110000000000;195.950000000000;196.790000000000;197.630000000000;198.470000000000;199.310000000000;200.150000000000;200.990000000000;201.830000000000;202.670000000000;203.510000000000;204.350000000000;205.190000000000;206.030000000000;206.870000000000;207.710000000000;208.540000000000;209.370000000000;210.200000000000;211.030000000000;211.860000000000;212.690000000000;213.520000000000;214.350000000000;215.180000000000;216.010000000000;216.840000000001;217.670000000001;218.500000000001;219.330000000001;220.160000000001;220.990000000001;221.820000000001;222.650000000001;223.480000000001;224.310000000001;225.140000000001;225.970000000001;226.790000000001;227.610000000001;228.430000000001;229.250000000001;230.070000000001;230.890000000001;231.710000000001;232.530000000001;233.350000000001;234.170000000001;234.990000000001;235.810000000001;236.630000000001;237.450000000001;238.270000000001;239.090000000001;239.910000000001;240.730000000001;241.550000000001;242.370000000001;243.190000000000;244.010000000000;244.830000000000;245.650000000000;246.460000000000;247.270000000000;248.080000000000;248.890000000000;249.700000000000;250.510000000000;251.320000000000;252.130000000000;252.940000000000;253.750000000000;254.560000000000;255.370000000001;256.180000000000;256.990000000000;257.800000000000;258.610000000000;259.420000000000;260.230000000001;261.040000000001;261.850000000001;262.660000000001;263.470000000001;264.280000000001;265.090000000001;265.900000000001;266.700000000001;267.500000000001;268.300000000001;269.100000000001;269.900000000001;270.700000000001;271.500000000001;272.300000000001;273.100000000001;273.900000000001;274.700000000001;275.500000000001;276.300000000001;277.100000000001;277.900000000001;278.700000000001;279.500000000001;280.300000000001;281.100000000001;281.900000000001;282.700000000001;283.500000000001;284.300000000001;285.100000000001;285.900000000001;286.700000000001;287.500000000001;288.290000000001;289.080000000001;289.870000000001;290.660000000001;291.450000000001;292.240000000001;293.030000000001;293.820000000001;294.610000000001;295.400000000001;296.190000000001;296.980000000001;297.770000000001;298.560000000001;299.350000000001;300.140000000001;300.930000000001;301.720000000001;302.510000000001;303.300000000001;304.090000000001;304.880000000001;305.670000000001;306.460000000001;307.250000000001;308.040000000001;308.830000000001;309.620000000001;310.410000000001;311.200000000001;311.980000000001;312.760000000001;313.540000000001;314.320000000001;315.100000000001;315.880000000001;316.660000000001;317.440000000001;318.220000000001;319.000000000001;319.780000000001;320.560000000001;321.340000000001;322.120000000001;322.900000000001;323.680000000001;324.460000000001;325.240000000001;326.020000000001;326.800000000001;327.580000000001;328.360000000001;329.140000000001;329.920000000001;330.700000000001;331.480000000001;332.260000000001;333.040000000001;333.820000000001;334.600000000001;335.380000000001;336.150000000001;336.920000000001;337.690000000001;338.460000000001;339.230000000001;340.000000000000;340.770000000000;341.540000000000;342.310000000000;343.080000000000;343.850000000000;344.620000000000;345.390000000000;346.160000000000;346.930000000000;347.700000000000;348.470000000000;349.240000000000;350.010000000000;350.780000000000;351.550000000000;352.320000000000;353.090000000000;353.860000000000;354.630000000000;355.400000000000;356.170000000000;356.940000000000;357.710000000000;358.480000000000;359.250000000000;360.020000000000;360.790000000000;361.560000000000;362.320000000000;363.080000000000;363.840000000000;364.600000000000;365.360000000000;366.120000000000;366.880000000000;367.640000000000;368.410000000000;369.170000000000;369.930000000000;370.690000000000;371.450000000000;372.210000000000;372.970000000000;373.730000000000;374.490000000000;375.250000000000;376.010000000000;376.770000000000;377.530000000000;378.290000000000;379.050000000000;379.810000000000;380.570000000000;381.330000000000;382.090000000000;382.850000000000;383.610000000000;384.370000000000;385.130000000000;385.890000000000;386.650000000000;387.410000000000;388.170000000000;388.930000000000;389.690000000000;390.440000000000;391.190000000000;391.940000000000;392.690000000000;393.440000000000;394.190000000000;394.940000000000;395.690000000000;396.440000000000;397.190000000000;397.940000000000;398.690000000000;399.440000000000;400.190000000000;400.940000000000;401.690000000000;402.440000000000;403.190000000000;403.940000000000;404.690000000000;405.440000000000;406.190000000000;406.940000000000;407.690000000000;408.440000000000;409.190000000000;409.940000000000;410.690000000000;411.440000000000;412.190000000000;412.940000000000;413.690000000000;414.440000000000;415.190000000000;415.940000000000;416.690000000000;417.440000000000;418.190000000000;418.940000000000;419.690000000000;420.440000000000;421.180000000000;421.920000000000;422.660000000000;423.400000000000;424.140000000000;424.880000000000;425.620000000000;426.360000000000;427.100000000000;427.840000000000;428.580000000000;429.320000000000;430.060000000000;430.800000000000;431.540000000000;432.280000000000;433.020000000000;433.760000000000;434.500000000000;435.240000000000;435.980000000000;436.720000000000;437.450000000000;438.190000000000;438.930000000000;439.670000000000;440.410000000000;441.150000000000;441.890000000000;442.630000000000;443.370000000000;444.110000000000;444.850000000000;445.590000000000;446.330000000000;447.070000000000;447.810000000000;448.550000000000;449.290000000000;450.030000000000;450.770000000000;451.510000000000;452.250000000000;452.990000000000;453.720000000000;454.450000000000;455.180000000000;455.910000000000;456.640000000000;457.370000000000;458.100000000000;458.830000000000;459.560000000000;460.290000000000;461.020000000000;461.750000000000;462.480000000000;463.210000000000;463.940000000000;464.670000000000;465.400000000000;466.130000000000;466.860000000000;467.590000000000;468.320000000000;469.050000000000;469.780000000000;470.510000000000;471.240000000000;471.970000000001;472.700000000001;473.430000000001;474.160000000001;474.890000000001;475.620000000001;476.350000000001;477.080000000001;477.810000000001;478.540000000001;479.270000000001;480.000000000001;480.730000000001;481.460000000001;482.190000000001;482.920000000001;483.650000000001;484.380000000001;485.110000000001;485.840000000001;486.570000000001;487.300000000001;488.030000000001;488.750000000001;489.470000000001;490.190000000001;490.910000000001;491.630000000001;492.350000000001;493.070000000001;493.790000000001;494.510000000001;495.230000000001;495.950000000001;496.670000000001;497.390000000001;498.110000000001;498.830000000001;499.550000000001;500.270000000001;500.990000000001;501.710000000001;502.430000000001;503.150000000001;503.870000000002;504.590000000002;505.310000000002;506.030000000002;506.750000000002;507.470000000002;508.190000000002;508.910000000002;509.630000000002;510.350000000002;511.070000000002;511.790000000002;512.510000000002;513.230000000002;513.950000000002;514.670000000002;515.390000000002;516.110000000002;516.830000000002;517.550000000002;518.270000000002;518.990000000002;519.710000000002;520.430000000002;521.150000000002;521.870000000002;522.590000000002;523.310000000002;524.030000000002;524.750000000002;525.470000000002;526.180000000002;526.890000000002;527.600000000002;528.310000000002;529.020000000003;529.730000000003;530.440000000003;531.150000000003;531.860000000003;532.570000000003;533.280000000003;533.990000000003;534.700000000003;535.410000000003;536.120000000003;536.830000000003;537.540000000003;538.250000000003;538.960000000003;539.670000000003;540.380000000003;541.090000000003;541.800000000003;542.510000000003;543.220000000003;543.930000000003;544.640000000003;545.350000000003;546.060000000003;546.770000000003;547.480000000003;548.190000000004;548.900000000004;549.610000000004;550.320000000004;551.030000000004;551.740000000004;552.450000000004;553.160000000004;553.870000000004;554.580000000004;555.290000000004;556.000000000004;556.710000000004;557.420000000004;558.130000000004;558.840000000004;559.550000000004;560.260000000004;560.970000000004;561.680000000004;562.390000000004;563.100000000004;563.810000000004;564.520000000004;565.230000000004;565.940000000004;566.650000000004;567.360000000004;568.060000000005;568.760000000005;569.460000000005;570.160000000005;570.860000000005;571.560000000005;572.260000000005;572.960000000005;573.660000000005;574.360000000005;575.060000000005;575.760000000005;576.460000000005;577.160000000005;577.860000000005;578.560000000005;579.260000000005;579.960000000005;580.660000000005;581.360000000005;582.060000000005];
z_step = [0;1;1;1;1;1;1;1;1;1;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.990000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.970000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.950000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.930000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.910000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.890000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.870000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.850000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.830000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.810000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.790000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.770000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.770000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.750000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.730000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.730000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.710000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000];

alpha=y(1);
beta=y(2);
gamma=y(3);
R_net = alpha+beta*exp(-z/gamma) ;

v=y(4);
gra_ca = y(5);

%------- initialize parameters------
J = length(z);
N = J;

t = zeros(N,1); 
for i = 2:N
    t(i) = t(i-1) + t_step;
end

fc=1.0;


rho_s = 2.7;    % g/cm^3 ->g/m^3
rho_f = 1;      % g/cm^3 ->g/m^3

temp_T = 0.01651*z+275.8;

f_a = 0;
f_b = 70.2/100;
f_c = 1/0.00076;
phi_z = f_a + f_b*exp(-z/f_c);  % porosity over depth

D0 = zeros(length(z),1);
D_ca = zeros(length(z),1);

for i = 1:length(z)
    D0(i) = (3.69+ 0.169 * (temp_T(i)-273.15)) * 3.65 * 24 * 36;
    D_ca(i) = D0(i) / (1-log(phi_z(i)^2));
end


J = length(z);
N = length(t);
Ca_pore = zeros(N,J);
K_aq = 0;   % adsoprtion coefficient 


for n =1:N
    Ca_pore(n,n:n+1) = 10.62 + 0.161*t(N-n+1);    
end

Ca_pore(2,1) = Ca_pore(2,2)+ z_step(2)* gra_ca;


%-----calculation
for n = 2: N-1
    
    a10 = 2*D_ca(n-2+1)*t_step/z_step(n-2+2)^2;
    b10 = t_step*v/z_step(n-2+2);

    Ca_pore(n+1,2) = ((a10-b10)*Ca_pore(n,2+1) + (a10+b10)*(Ca_pore(n, 3) + 2 * z_step(n)* gra_ca) + (1-a10)*Ca_pore(n-1,2) + 2*10*1000 * t_step * R_net(n-2+1) *fc* rho_s / rho_f * (1-phi_z(n-2+2)) / phi_z(n-2+2)) / (1+a10);
      
    for j = 3:n
        
        a1 = 2*D_ca(n-j+1)*t_step/z_step(n-j+2)^2;
        b1 = t_step*v/z_step(n-j+2);
        
        Ca_pore(n+1,j) = ((a1-b1)*Ca_pore(n,j+1) + (a1+b1)*Ca_pore(n,j-1) + (1-a1)*Ca_pore(n-1,j) + 2*10*1000 * t_step * R_net(n-j+1) *fc* rho_s / rho_f * (1-phi_z(n-j+2)) / phi_z(n-j+2)) / (1+a1);
        
    end
    
end

Ca_pore(:,1)=Ca_pore(:,2);


t_total = t(end);


t1 = round((t_total - 20)/t_step);
t2 = round((t_total - 15)/t_step);
t3 = round((t_total - 10)/t_step);

figure
plot(fliplr(Ca_pore(N,1:J)),z,'linewidth',2)
hold on
plot(fliplr(Ca_pore(N-t1,1:J-t1)),z(1+t1:end),'--','linewidth',2)
plot(fliplr(Ca_pore(N-t2,1:J-t2)),z(1+t2:end),':','linewidth',2)
plot(fliplr(Ca_pore(N-t3,1:J-t3)),z(1+t3:end),'-.','linewidth',2)

set(gca,'Ydir','reverse')
title("Site 805");
xlabel('Calcium (mM) in pore water');
ylabel('Present-day depth (m)')
set(gca,'FontSize',12)

[Leg1,Site1,Topcm1,Botcm,Depthmbsf1,CalciumCamM,ChlorinityClmM,MagnesiumMgmM,pHpHna,SodiumNamM,StrontiumSruM,SulfateSO4mM,SilicaH4SiO4uM,AlkalinityALKmM,SalinitySALna] = importfile_water('water.xlsx');

index=(Site1==site_Number);
depth2=Depthmbsf1(index);
Ca2_data=CalciumCamM(index);

scatter (Ca2_data,depth2);

legend('t=27.9 m.y., present day','t=20 m.y.','t=15 m.y.','t=10 m.y.','Calcium Data')

% print('calcium805.jpg','-djpeg','-r600');
% print('calcium805.pdf','-dpdf');
savefig('calcium805.fig');

